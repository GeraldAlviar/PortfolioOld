''This is a VBA Macro code snippet for detecting a Microsoft Excel workbook using its file name. You may also use wildcards to enhance workbook detection.
''Example: WorkbookNo, WorkbookNo(1), and WorkbookNo(2). You can use "WorkbookNo*" to detect filename variations.
''Created by: Gerald John Alviar https://ph.linkedin.com/in/geraldalviar


Sub DetectSpreadsheet()

Call ClearOutputData 'Used to clear the output data before detecting new spreadsheet

Dim Ct As Long 'Detect spreadsheet using wildcard/partial file name
For Each Wb In Application.Workbooks
    If Wb.Name Like "*Spreadsheet_Name" Then  'use asterisk (*) for wildcard search
        Ct = Ct + 1
        Wb.Activate  'Selecting the spreadsheet if a certain workbook is found
        Exit For
    End If
Next Wb
If Ct = 0 Then MsgBox "PT Spreadsheet Not Found" 'Find spreadsheet using wildcard/partial file name
If Ct = 0 Then Exit Sub

If Range("Q2").Value = 0 Then 'Modified Spreadsheet Detection
MsgBox "Modified Spreadsheet Detected"
Exit Sub
End If
